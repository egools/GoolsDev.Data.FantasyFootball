YUI.add("af-applet-load",function(e){"use strict";var t=e.Af.AppletDom,a=e.Af.Utils,p=a.stringParseKV,l="applet-defer";function o(){}o.prototype={name:"applet.load",execute:function(a,o,n){if("applet.load"===o.action||"loadapplet"===o.action){var i=o.params.guid?t.getNode(o.params.guid):o.params.node;this.loadApplet(a,i,p(i.getData(l)),o.callback)}else"page.init"===o.action&&t.all(e.one("body"),e.bind(function(e){var t=e.getData(l);t&&"custom"!==(t=p(t)).when&&this.loadApplet(a,e,t,o.callback)},this));n()},replaceAppletContent:function(t,a){if(t&&a&&a.html){var p,l=e.Node.create(a.html);l=l.one("div.js-applet")||l,e.Af.Dom.setHTML(t,l.getHTML()),(p=a.js||a.assets)&&e.Af.Dom.jsAttach(p)}},loadApplet:function(o,n,i,r){if(!n)return r&&r("invalid node");var c=this,s=t.getGuid(n),d=t.getType(n),m=p(n.getData("applet-params")),u=e.merge({guid:s,type:d,content_id:"chrome"},m),f={id_param:"guid"};i&&(i.batch&&(f.batch=i.batch),i.timeout&&(f.timeout=i.timeout)),e.Af.Transport.read("applet.content",u,{config:f},function(t,p){return t||!a.objectGetValue(p,"content.chrome.html")?(e.Af.Message.show(n,{level:"error",token:"ERR_LOAD",template:"ape-applet-templates-reload"}),r&&r(t)):(n.removeAttribute("data-"+l),c.replaceAppletContent(n,p.content.chrome),o.execControllers({action:"applet.init",params:{node:n,replace:!0}}),e.use("stencil",function(e){e.Stencil.initAll(n)}),o.fire("appletdeferload",{applet:{guid:s,type:d}}),r&&r(null))})}},e.namespace("Af").AppletLoad=o},"@VERSION@",{requires:["af-applet-dom","af-message","af-transport","ape-applet-templates-reload"]});YUI.add("af-dom",function(e){"use strict";e.namespace("Af").Dom={parseForm:function(t){var n={};return e.one(t).all("input,select,textarea").each(function(t){var a=t.getData("setting")||t.get("name"),c=t.get("tagName"),o=t.get("type");"INPUT"!==c||"radio"!==o?"INPUT"!==c||"checkbox"!==o?("INPUT"!==c||"submit"!==o&&"reset"!==o)&&(n[a]=t.get("value")):t.get("checked")&&(e.Lang.isArray(n[a])||(n[a]=[]),n[a].push(t.get("value"))):t.get("checked")&&(n[a]=t.get("value"))}),n},jsAttach:function(t,n){var a,c,o=e.Node.create("<div></div>"),r="";o.setContent(t),o.all("script").each(function(e){r+=e._node.text+";"}),a=e.one(document.createElement("script"));try{a.set("text",r)}catch(i){a._node.text=r}c=document.write,document.write=this.noop,(n=n||e.one("head")).appendChild(a),document.write=c},purgeSubtree:function(e){e&&e.get("children").each(function(e){e.purge(!0)})},setHTML:function(e,t){e&&e.empty().setHTML(t)}}},"@VERSION@",{requires:["node-base","node-core"]});/*
YUI 3.18.1 (build f7e7bcb)
Copyright 2014 Yahoo! Inc. All rights reserved.
Licensed under the BSD License.
http://yuilibrary.com/license/
*/

YUI.add("querystring-stringify",function(e,t){var n=e.namespace("QueryString"),r=[],i=e.Lang;n.escape=encodeURIComponent,n.stringify=function(e,t,s){var o,u,a,f,l,c,h=t&&t.sep?t.sep:"&",p=t&&t.eq?t.eq:"=",d=t&&t.arrayKey?t.arrayKey:!1;if(i.isNull(e)||i.isUndefined(e)||i.isFunction(e))return s?n.escape(s)+p:"";if(i.isBoolean(e)||Object.prototype.toString.call(e)==="[object Boolean]")e=+e;if(i.isNumber(e)||i.isString(e))return n.escape(s)+p+n.escape(e);if(i.isArray(e)){c=[],s=d?s+"[]":s,f=e.length;for(a=0;a<f;a++)c.push(n.stringify(e[a],t,s));return c.join(h)}for(a=r.length-1;a>=0;--a)if(r[a]===e)throw new Error("QueryString.stringify. Cyclical reference");r.push(e),c=[],o=s?s+"[":"",u=s?"]":"";for(a in e)e.hasOwnProperty(a)&&(l=o+a+u,c.push(n.stringify(e[a],t,l)));return r.pop(),c=c.join(h),!c&&s?s+"=":c}},"3.18.1",{requires:["yui-base"]});
YUI.add("af-content",function(e,t){"use strict";var n=e.Lang,i=e.Af.Utils,o=e.Af.Config,r=e.Af.Dom,s=e.Mjata.REST.HTTP,p=n.isFunction,a=n.isNumber,l=n.isObject,c=n.isString,u=i.objectGetValue,d="replace_content",m=".js-applet",h="appletsinit";e.namespace("Af").Content={simple:function(t,n,o){return t=e.one(t),o=o||i.noop,t&&n&&n.html?(r.setHTML(t,n.html),n.js&&r.jsAttach(n.js),o(null),this):(o("invalid param"),this)},applet:function(t,n,o,r){return r=r||i.noop,t&&n&&o?(n=e.one(n))?void(c(t)?(s=u(e,t))?this._initApplet(s,o,{node:n,where:d},r):e.onceAfter(h,function(e){this._initApplet(e.applets,o,{node:n,where:d},r)},this):l(t)?this._initApplet(t,o,{node:n,where:d},r):e.onceAfter(h,function(e){this._initApplet(e.applets,o,{node:n,where:d},r)},this)):r("invalid node"):r("invalid param");var s},remoteApplet:function(t,n,i){n=n||{};var r,s=o.get("context")||{},p=o.get("td")||{},l=e.merge(n.params,{initApplet:0,initStencil:0,m_id:n.type,m_mode:"json"}),c=n.placement&&n.placement.node,u=n.placement&&n.placement.where,d={};return n.type?(c=e.one(c))?(a(u)||(u=u||"replace"),"https:"===window.location.protocol?l.ssl=1:l.ssl=0,!l.site&&s.site&&(l.site=s.site),!l.lang&&s.lang&&(l.lang=s.lang),!l.region&&s.region&&(l.region=s.region),!l.xhr_path&&p.api&&(l.xhr_path=p.api),n.guid&&(l.instance_id=n.guid),r=n.uri||p.remote||"/_remote",a(n.timeout)&&n.timeout>0&&(d.timeout=n.timeout),void this["post"===n.method?"_post":"_get"](t,r,l,c,u,d,i)):i&&i("missing options.placement.node"):i&&i("missing options.type")},_get:function(t,n,i,o,r,p,a){var l=this;n+="?"+e.QueryString.stringify(i),s.get(n,{},p||{},function(e,n){l._parseContent(t,void 0,o,r,a,e,n)})},_post:function(e,t,n,i,o,r,p){var a=this;t+="?m_id="+encodeURIComponent(n.m_id),n.ctrl&&(t+="&ctrl="+encodeURIComponent(n.ctrl)),s.post(t,{},n,r||{},function(t,n){a._parseContent(e,void 0,i,o,p,t,n)})},_parseContent:function(t,n,i,o,r,s,p){if(s)return r&&r(s);if(!p||!p.responseText)return r&&r("empty content");try{n=e.JSON.parse(p.responseText),this._initApplet(t,n,{node:i,where:o},r)}catch(a){return r&&r("invalid json content:"+a.message)}},_initApplet:function(t,n,i,o){return p(t.initApplet)?(i=e.merge({where:"replace"},i),n&&(i.where===d&&(s=(s=e.Node.create(n.html)).one("div.js-applet")||s,n.html=s.getHTML(),i.where="replace"),r=this._insert(n,i)),r?(e.use("stencil",function(e){var t=e.Stencil;t&&t.initAll&&t.initAll(r)}),void e.later(5,null,function(){t.initApplet(r,!0),o(null)})):o("missing applet node")):o("missing initApplet()");var r,s},_insert:function(t,n){var i,o;switch(n.node.insert(t.html,n.where),n.where){case"before":i=n.node.previous(m);break;case"after":i=n.node.next(m);break;case"replace":i=n.node.one(m)||n.node;break;default:e.Lang.isNumber(n.where)&&(i=n.node.get("children").item(n.where))}return i&&(o=t.js||t.assets)&&r.jsAttach(o),i},rmp:function(t){e.use("media-rmp",function(e){e.Media.RMP.load(t)})}}},"@VERSION@",{requires:["af-config","af-dom","af-utils","json-parse","mjata-rest-http","node-pluginhost","querystring-stringify"]});YUI.add("af-applet-mgr",function(e,t){"use strict";var o=e.Af.AppletDom,a=e.Af.Beacon,p=e.Af.Transport,n=e.Af.Utils,i=e.Lang.isFunction;function r(){}function l(){}function c(){}function m(){}r.prototype={name:"applet.add",execute:function(e,t,o){if("applet.add"!==t.action)return o();this.addApplet(e,t.params.type,t.params.config,t.params.settings,t.params.location,t.callback),o()},addApplet:function(t,a,i,r,l,c){c=c||n.noop,a?((l=l||{}).container=l.container||o.getContainerGuid(e.one(o.selectors().container)),l.index=l.index||0,p.create("applet",{type:a},{config:i,settings:r,location:l},function(a,p){if(!a&&n.objectGetValue(p,"content.chrome.html")){var i,r,m=o.getContainerNode(l.container),s=p.content.chrome;i=e.Node.create(s.html),(m=o.getContainerContentNode(m)).insert(i,l.index),s.assets&&e.Af.Dom.jsAttach(s.assets),t.execControllers({action:"applet.init",params:{node:i,replace:!1}}),e.use("stencil",function(e){e.Stencil.initAll(i)}),r=o.getGuid(i),t.fire("appletadd",{applet:{guid:r,type:o.getType(i)}}),c(null,null)}else c(a||"no content")})):c("missing type")}},l.prototype={name:"applet.move",execute:function(e,t,o){"applet.move"===t.action&&this.moveApplet(e,t.params.guid,t.params.from,t.params.to,t.params,t.callback),o()},moveApplet:function(e,t,a,r,l,c){i(l)&&(c=l,l={}),c=c||n.noop;var m,s=!0===(l&&l.moveBeforePersist),f=!1!==(l&&l.save),u=this;if((a=a||o.getLocation(t))&&r){if(m=o.getType(t),!f)return u._updateDom(e,t,a,r),void c();s&&u._updateDom(e,t,a,r),p.update("applet.layout",{guid:t,type:m},{from:a,to:r},function(o){o?c(o):(s||u._updateDom(e,t,a,r),c())})}else c("invalid from/to location")},_updateDom:function(e,p,n,i){var r=e.applets[p];if(o.getContainerNode(i.container))o.move(p,n,i);else if(o.remove(p),r){try{r.destroy({remove:!0})}catch(l){a.error(t+":destroy",{applet:r.get("type")},l)}delete e.applets[p]}e.fire("appletmove",{applet:{guid:p,type:r?r.get("type"):null,from:n,to:i}})}},c.prototype={name:"applet.remote",execute:function(t,o,a){var p=e.Af.Content;"applet.remote"===o.action?p.remoteApplet(t,o.params,o.callback):"page.init"===o.action&&t.after("*:remoteapplet",function(e){var o=e.remoteapplet;p.remoteApplet(t,o,o&&o.callback)}),a()}},m.prototype={name:"applet.remove",execute:function(e,t,o){"applet.remove"===t.action||"removeapplet"===t.action?this.removeApplet(e,t.params.guid,t.params,t.callback):"page.init"===t.action&&e.after("*:removeapplet",function(t){this.removeApplet(e,t.removeapplet.guid||t.applet.guid,t.removeapplet)},this),o()},removeApplet:function(e,r,l,c){if(i(l)&&(c=l,l={}),c=c||n.noop,r){var m=o.getType(r)||null,s=!0===(l&&l.removeBeforePersist);if(!(!1!==(l&&l.save)))return f(),void c();s&&f(),p.update("applet.layout",{guid:r,type:m},{from:o.getLocation(r),to:null},function(e){e?c(e):(s||f(),c())})}else c("missing guid");function f(){o.remove(r,function(){e.fire("appletremove",{applet:{guid:r,type:m}})});var p=e.applets[r];if(p){try{p.destroy({remove:!0})}catch(n){a.error(t+":destroy",{applet:m},n)}delete e.applets[r]}}}},e.namespace("Af").AppletAdd=r,e.Af.AppletMove=l,e.Af.AppletRemote=c,e.Af.AppletRemove=m},"@VERSION@",{requires:["af-applet-dom","af-beacon","af-content","af-transport","af-utils"]});YUI.add("af-applet-savesettings",function(e){"use strict";var t="container";function s(){}s.prototype={name:"applet.savesettings",execute:function(e,t,s){"applet.savesettings"!==t.action&&"savesettings"!==t.action||this.saveSettings(e,t.params.guid,t.params),s()},saveSettings:function(s,a,i){if(s.applets&&s.applets[a]){i=i||{};var n,o,r=s.applets[a];(n=i.src?r.get(t).one(i.src):(o=r.getView("settings"))&&o.get("container").one("form"))&&r.get("model").saveSettings(e.Af.Dom.parseForm(n),{critical:i.critical},function(n){if(n&&"invalid_settings"===n.code)e.Af.Message.show(r.get(t),{level:"error",content:n.message});else{if(i.showview){var o=r.getView(i.showview);o||(o=r.createView(i.showview))&&o.render(),o&&s.execControllers({action:"showview",params:{guid:a,view:i.showview}})}n&&e.Af.Message.show(r.get(t),{level:"error",token:n})}})}}},e.namespace("Af").AppletSaveSettings=s},"@VERSION@",{requires:["af-dom","af-message"]});YUI.add("af-applet-viewmgr",function(e){"use strict";var i="main",t="App-Chrome-on",a="container";function o(e){return e&&(e.isEditView||"settings"===e.get("name"))}function s(e,i){e&&i&&e.destroyView(i,{remove:!0,async:!0})}function p(){}function n(){}function r(){}p.prototype={name:"applet.showview",execute:function(e,i,t){"applet.showview"===i.action||"showview"===i.action?this.showView(e,i.params.guid,i.params):"page.init"===i.action&&e.after("*:showview",function(i){this.showView(e,i.applet&&i.applet.guid||i.target.get("guid"),i.showview)},this),t()},showView:function(e,p,n){if(e.applets&&e.applets[p]){n=n||{};var r,w=e.applets[p],c=n.view||i,l=n.region||w.regionForView(c)||i,f="true"===n.destroy||!0===n.destroy,g=w.getRegion(l),u=w.getView(c);u||(u=w.createView(n.view))&&u.render(),u&&(r=g.getView(),g.showView(u),o(u)?w.get(a).addClass(t):w.get(a).removeClass(t),r&&r!==u&&(o(r)||f)&&s(w,r))}}},n.prototype={name:"applet.closeview",execute:function(e,i,t){"applet.closeview"===i.action||"closeview"===i.action?this.closeView(e,i.params.guid,i.params):"page.init"===i.action&&e.after("*:closeview",function(i){this.closeView(e,i.applet&&i.applet.guid||i.target.get("guid"),i.closeview)},this),t()},closeView:function(e,t,a){if(e.applets&&e.applets[t]){a=a||{};var p,n,r,w=e.applets[t],c="true"===a.destroy||!0===a.destroy;p=o(r=w.getView(a.view))?"edit":w.regionForView(a.view)||i,(n=w.getRegion(p))&&(p===i?n.showView(w.getView(i)):n.closeView()),w.get("container").removeClass("App-Chrome-on"),(o(r)||c)&&s(w,r)}}},r.prototype={name:"applet.refreshview",execute:function(e,i,t){"applet.refreshview"!==i.action&&"refreshview"!==i.action||this.refreshView(e,i.params.guid,i.params),t()},refreshView:function(e,i,t){if(e.applets&&e.applets[i]){t=t||{};var a=e.applets[i],o=a.getView(t.view||"main");o||(o=a.createView(t.view)),o&&o.refresh(t)}}},e.namespace("Af").AppletShowView=p,e.namespace("Af").AppletCloseView=n,e.namespace("Af").AppletRefreshView=r},"@VERSION@",{requires:["af-applet-dom"]});YUI.add("af-applets",function(e,t){"use strict";var l=e.Lang.isFunction;function o(){var e=this;YUI.Env.Af=YUI.Env.Af||{},YUI.Env.Af.Applets=e,e.applets={},e._firstControllerNode=null,l(e.after)&&e.after("*:appletdestroyed",function(t){var l=t.applet||{},o=e.applets[l.guid];o&&l.clientId===o.clientId&&delete e.applets[l.guid]})}o.prototype={addController:function(e){if(!e||!e.name||"function"!=typeof e.execute)return!1;if(!this._firstControllerNode)return this._firstControllerNode={controller:e,next:null},!0;for(var t,l=this._firstControllerNode;l;){if(l.controller.name===e.name)return l.controller=e,!0;t=l,l=l.next}return t.next={controller:e,next:null},!0},execControllers:function(e){e&&e.action&&this._firstControllerNode&&this._execController(e,this._firstControllerNode)},_execController:function(e,t){if(e&&e.action&&t&&t.controller){var l=this;t.controller.execute(this,e,function(o){o||l._execController(e,t.next)})}},initializer:function(t){t=t||{};var l=e.Af,o="aptsInitializer",n=this;l.Utils.perfStart(o),n.addController(new l.AppletInit),n.addController(new l.AppletLoad),n.addController(new l.AppletAdd),n.addController(new l.AppletRemote),n.addController(new l.AppletRemove),n.addController(new l.AppletMove),n.addController(new l.AppletAction),n.addController(new l.AppletShowView),n.addController(new l.AppletCloseView),n.addController(new l.AppletRefreshView),n.addController(new l.AppletSaveSettings),e.Array.forEach(t.controllers,function(e){n.addController(e)}),n.execControllers({action:"page.init"}),l.Utils.perfStop(o)},getAppletLayout:function(){return e.Af.AppletDom.getLayout()},addApplet:function(e,t,l,o,n){var r={type:e,config:t,settings:l,location:o};this.execControllers({action:"applet.add",params:r,callback:n})},initApplet:function(e,t,o){l(t)&&(o=t,t=!1);var n={replace:!!t};"string"==typeof e?n.guid=e:n.node=e,this.execControllers({action:"applet.init",params:n,callback:o})},loadApplet:function(e,t){var l={};"string"==typeof e?l.guid=e:l.node=e,this.execControllers({action:"applet.load",params:l,callback:t})},moveApplet:function(t,o,n,r,a){l(r)&&(a=r,r={});var p={action:"applet.move",params:e.merge({guid:t,from:o,to:n},r),callback:a};this.execControllers(p)},removeApplet:function(t,o,n){l(o)&&(n=o,o={});var r={action:"applet.remove",params:e.merge({guid:t},o),callback:n};this.execControllers(r)}},e.namespace("Af").Applets=o,e.Af.getApplet=function(t){return e.Af.Utils.objectGetValue(YUI.Env.Af,"Applets.applets."+t)||null}},"@VERSION@",{requires:["af-applet-action","af-applet-init","af-applet-load","af-applet-mgr","af-applet-savesettings","af-applet-viewmgr","af-dom","af-utils"]});